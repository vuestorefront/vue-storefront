{"version":3,"file":"index.js","sources":["../src/api.ts","../src/index.server.ts"],"sourcesContent":["import { ApiContext, ContentSearchParams } from './types'\nimport { Logger } from '@vue-storefront/core'\n\nexport const getContent = async (\n  { client, config }: ApiContext,\n  { slug }: ContentSearchParams,\n): Promise<any> => {\n  const { token, cacheProvider } = config\n  const Storyblok = new client({\n    accessToken: token,\n    cache: {\n      clear: 'auto',\n      type: cacheProvider,\n    },\n  })\n  let response = null\n  try {\n    const { data } = await Storyblok.get(`cdn/stories/${slug}`)\n    response = data?.story\n  } catch (error) {\n    Logger.error(\"Can't get data from Storyblok.\", error)\n  }\n  return response\n}\n","import { apiClientFactory } from '@vue-storefront/core'\nimport { ApiContext, ContentSearchParams } from './types'\nimport StoryblokClient from 'storyblok-js-client'\n\nimport { getContent } from './api'\n\nconst setup = ({ token, cacheProvider }: ContentSearchParams): ApiContext => {\n  return {\n    client: StoryblokClient,\n    config: {\n      token,\n      cacheProvider,\n    },\n  }\n}\n\nconst { createApiClient } = apiClientFactory({\n  onCreate: setup,\n  api: {\n    getContent,\n  },\n} as any)\n\nexport { createApiClient }\n\n"],"names":["Logger","StoryblokClient","apiClientFactory"],"mappings":";;;;;;;;;;;;AAGO,IAAM,UAAU,GAAG,UACxB,EAA8B,EAC9B,EAA6B;QAD3B,MAAM,YAAA,EAAE,MAAM,YAAA;QACd,IAAI,UAAA;;;;;;oBAEE,KAAK,GAAoB,MAAM,MAA1B,EAAE,aAAa,GAAK,MAAM,cAAX,CAAW;oBACjC,SAAS,GAAG,IAAI,MAAM,CAAC;wBAC3B,WAAW,EAAE,KAAK;wBAClB,KAAK,EAAE;4BACL,KAAK,EAAE,MAAM;4BACb,IAAI,EAAE,aAAa;yBACpB;qBACF,CAAC,CAAA;oBACE,QAAQ,GAAG,IAAI,CAAA;;;;oBAEA,qBAAM,SAAS,CAAC,GAAG,CAAC,iBAAe,IAAM,CAAC,EAAA;;oBAAnD,IAAI,GAAK,CAAA,SAA0C,MAA/C;oBACZ,QAAQ,GAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,KAAK,CAAA;;;;oBAEtBA,WAAM,CAAC,KAAK,CAAC,gCAAgC,EAAE,OAAK,CAAC,CAAA;;wBAEvD,sBAAO,QAAQ,EAAA;;;;CAChB;;ACjBD,IAAM,KAAK,GAAG,UAAC,EAA6C;QAA3C,KAAK,WAAA,EAAE,aAAa,mBAAA;IACnC,OAAO;QACL,MAAM,EAAEC,mCAAe;QACvB,MAAM,EAAE;YACN,KAAK,OAAA;YACL,aAAa,eAAA;SACd;KACF,CAAA;AACH,CAAC,CAAA;IAEO,eAAe,GAAKC,qBAAgB,CAAC;IAC3C,QAAQ,EAAE,KAAK;IACf,GAAG,EAAE;QACH,UAAU,YAAA;KACX;CACK,CAAC;;;;"}